@import "tailwindcss";

@theme {
  --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  --font-mono: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
}

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Theme tokens and transitions */
:root {
  --bg: 0 0% 100%;
  --fg: 222 47% 11%;
  --surface: 0 0% 100%;
  --surface-alt: 210 40% 98%;
  --border: 215 15% 85%;
  --muted: 215 15% 45%;
  --primary: 243 75% 58%;
  --primary-fg: 0 0% 100%;
  --success: 142 72% 35%;
  --warning: 45 100% 45%;
  --danger: 0 72% 45%;
  --focus-ring: 243 75% 58%;
  color-scheme: light;
}

[data-theme="dark"] {
  --bg: 222 22% 10%;
  --fg: 210 40% 96%;
  --surface: 222 15% 12%;
  --surface-alt: 222 15% 16%;
  --border: 222 10% 30%;
  --muted: 222 10% 60%;
  --primary: 243 75% 70%;
  --primary-fg: 0 0% 100%;
  --success: 142 72% 45%;
  --warning: 45 100% 55%;
  --danger: 0 72% 60%;
  --focus-ring: 243 75% 70%;
  color-scheme: dark;
}

/* Auto mode mirrors OS only when no explicit theme is set */
@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) {
    --bg: 222 22% 10%;
    --fg: 210 40% 96%;
    --surface: 222 15% 12%;
    --surface-alt: 222 15% 16%;
    --border: 222 10% 30%;
    --muted: 222 10% 60%;
    --primary: 243 75% 70%;
    --primary-fg: 0 0% 100%;
    --success: 142 72% 45%;
    --warning: 45 100% 55%;
    --danger: 0 72% 60%;
    --focus-ring: 243 75% 70%;
    color-scheme: dark;
  }
}

/* Base app theming using tokens */
.theme-base {
  background-color: hsl(var(--bg));
  color: hsl(var(--fg));
}

/* Smooth fade transitions during theme switching */
html.theme-transition, html.theme-transition body, html.theme-transition * {
  transition: background-color 160ms ease, color 160ms ease, border-color 160ms ease;
}
@media (prefers-reduced-motion: reduce) {
  html.theme-transition, html.theme-transition body, html.theme-transition * {
    transition: none;
  }
}

/* Focus ring token */
:root {
  --focus-width: 2px;
}
:root :focus-visible {
  outline: var(--focus-width) solid hsl(var(--focus-ring));
  outline-offset: 2px;
}

/* Semantic token utilities (Tailwind v4 @utility) */
@utility text-fg {
  color: hsl(var(--fg));
}
@utility bg-bg {
  background-color: hsl(var(--bg));
}
@utility bg-surface {
  background-color: hsl(var(--surface));
}
@utility bg-surface-alt {
  background-color: hsl(var(--surface-alt));
}
@utility border-border {
  border-color: hsl(var(--border));
}
@utility text-muted {
  color: hsl(var(--muted));
}
@utility text-primary {
  color: hsl(var(--primary));
}
@utility bg-primary {
  background-color: hsl(var(--primary));
}
@utility text-primary-fg {
  color: hsl(var(--primary-fg));
}
@utility ring-focus {
  --tw-ring-color: hsl(var(--focus-ring));
}
@utility outline-focus {
  outline-color: hsl(var(--focus-ring));
}

/* Reusable button styles */
@layer components {
  .btn {
    @apply inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium
           transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-primary {
    @apply bg-indigo-600 text-white hover:bg-indigo-500 focus:ring-indigo-400 dark:bg-indigo-500 dark:hover:bg-indigo-400;
  }

  .btn-secondary {
    @apply bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-400 dark:bg-gray-700 dark:text-gray-100 dark:hover:bg-gray-600;
  }

  .btn-ghost {
    @apply bg-transparent text-indigo-600 hover:bg-indigo-50 dark:text-indigo-300 dark:hover:bg-gray-800;
  }

  .btn-danger {
    @apply bg-red-600 text-white hover:bg-red-500 focus:ring-red-400 dark:bg-red-500 dark:hover:bg-red-400;
  }

  .btn-success {
    @apply bg-green-600 text-white hover:bg-green-500 focus:ring-green-400 dark:bg-green-500 dark:hover:bg-green-400;
  }

  /* Celebratory 100% badge styles */
  .badge-perfect {
    @apply bg-green-600 text-white rounded-lg shadow-lg;
    background-image: radial-gradient(circle at 30% 30%, rgba(34,197,94,0.35), transparent 50%),
      radial-gradient(circle at 70% 70%, rgba(34,197,94,0.25), transparent 50%),
      linear-gradient(180deg, rgba(34,197,94,0.95), rgba(22,163,74,0.95));
    box-shadow: 0 6px 18px rgba(34, 197, 94, 0.35), inset 0 0 12px rgba(255,255,255,0.15);
    animation: badgePulse 1.2s ease-in-out infinite;
    position: relative;
    overflow: hidden;
  }

  .badge-perfect::after {
    content: '';
    position: absolute;
    top: -40%;
    left: -40%;
    width: 180%;
    height: 180%;
    background: radial-gradient(closest-side, rgba(255,255,255,0.16), rgba(255,255,255,0) 70%);
    transform: rotate(25deg);
    animation: glossSweep 2.4s ease-in-out infinite;
    pointer-events: none;
  }

  /* Lightning variant for certificate badge */
  .badge-lightning {
    @apply text-white rounded-lg shadow-2xl;
    background: radial-gradient(circle at 30% 30%, rgba(147, 197, 253, 0.35), transparent 50%),
      radial-gradient(circle at 70% 70%, rgba(147, 197, 253, 0.25), transparent 50%),
      linear-gradient(180deg, rgba(59,130,246,0.95), rgba(29,78,216,0.95));
    box-shadow: 0 10px 28px rgba(29, 78, 216, 0.45), inset 0 0 18px rgba(255,255,255,0.20), 0 0 24px rgba(59,130,246,0.55);
    position: relative;
    overflow: hidden;
    animation: pulseGlow 1.25s ease-in-out infinite;
  }

  .badge-lightning::before {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    padding: 2px; /* border thickness */
    background: conic-gradient(from 180deg, rgba(255,255,255,0.0), rgba(255,255,255,0.8), rgba(255,255,255,0.0));
    -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
            mask-composite: exclude;
    animation: sparkTravel 2.2s linear infinite;
    pointer-events: none;
  }

  .badge-lightning::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -40%;
    width: 200%;
    height: 200%;
    background: radial-gradient(closest-side, rgba(255,255,255,0.22), rgba(255,255,255,0) 70%);
    transform: rotate(20deg);
    animation: glossSweep 2.6s ease-in-out infinite;
    mix-blend-mode: screen;
    pointer-events: none;
  }

  /* Green awarding animation for 100% HD seal */
  .badge-hd-award {
    @apply text-white rounded-lg shadow-2xl;
    background: radial-gradient(circle at 30% 30%, rgba(16, 185, 129, 0.35), transparent 50%),
      radial-gradient(circle at 70% 70%, rgba(16, 185, 129, 0.25), transparent 50%),
      linear-gradient(180deg, rgba(5, 150, 105, 0.95), rgba(4, 120, 87, 0.95));
    box-shadow: 0 10px 28px rgba(4, 120, 87, 0.45), inset 0 0 18px rgba(255,255,255,0.20), 0 0 24px rgba(16,185,129,0.55);
    position: relative;
    overflow: hidden;
    /* Gentle, non-infinite pulse for celebratory effect */
    animation: hdPulseGlow 1.25s ease-in-out 2;
  }

  .badge-hd-award::before {
    /* Remove spinning border for HD badge */
    content: none;
  }

  .badge-hd-award::after {
    /* Single sweep highlight, not continuous */
    content: '';
    position: absolute;
    top: -50%;
    left: -40%;
    width: 200%;
    height: 200%;
    background: radial-gradient(closest-side, rgba(255,255,255,0.22), rgba(255,255,255,0) 70%);
    transform: rotate(20deg);
    animation: glossSweep 1.2s ease-out 1;
    mix-blend-mode: screen;
    pointer-events: none;
  }
}

/* Classy multi-point gradient animation */
@keyframes gradientFlow {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

/* Energetic pulse for perfect badge */
@keyframes badgePulse {
  0% { transform: scale(1); box-shadow: 0 6px 18px rgba(34, 197, 94, 0.35), inset 0 0 12px rgba(255,255,255,0.15); }
  50% { transform: scale(1.04); box-shadow: 0 10px 28px rgba(34, 197, 94, 0.55), inset 0 0 18px rgba(255,255,255,0.22); }
  100% { transform: scale(1); box-shadow: 0 6px 18px rgba(34, 197, 94, 0.35), inset 0 0 12px rgba(255,255,255,0.15); }
}

@keyframes glossSweep {
  0% { transform: translateX(-10%) rotate(25deg); opacity: 0.6; }
  50% { transform: translateX(10%) rotate(25deg); opacity: 0.25; }
  100% { transform: translateX(-10%) rotate(25deg); opacity: 0.6; }
}

/* Pulsing electric glow for lightning badge */
@keyframes pulseGlow {
  0% { transform: scale(1); box-shadow: 0 10px 28px rgba(29,78,216,0.45), 0 0 0 rgba(59,130,246,0); }
  50% { transform: scale(1.035); box-shadow: 0 14px 36px rgba(29,78,216,0.65), 0 0 24px rgba(59,130,246,0.55); }
  100% { transform: scale(1); box-shadow: 0 10px 28px rgba(29,78,216,0.45), 0 0 0 rgba(59,130,246,0); }
}

/* Pulsing emerald glow for HD award badge */
@keyframes hdPulseGlow {
  0% { transform: scale(1); box-shadow: 0 10px 28px rgba(4,120,87,0.45), 0 0 0 rgba(16,185,129,0); }
  50% { transform: scale(1.035); box-shadow: 0 14px 36px rgba(4,120,87,0.65), 0 0 24px rgba(16,185,129,0.55); }
  100% { transform: scale(1); box-shadow: 0 10px 28px rgba(4,120,87,0.45), 0 0 0 rgba(16,185,129,0); }
}

/* Lightning crackle strokes moving around the border */
@keyframes lightningCrackle {
  0% { filter: drop-shadow(0 0 6px rgba(255,255,255,0.9)) hue-rotate(0deg); opacity: 0.85; }
  50% { filter: drop-shadow(0 0 14px rgba(255,255,255,1)) hue-rotate(25deg); opacity: 1; }
  100% { filter: drop-shadow(0 0 6px rgba(255,255,255,0.9)) hue-rotate(0deg); opacity: 0.85; }
}

/* Spark traveling around the edge */
@keyframes sparkTravel {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

body {
  @apply bg-gray-100 text-gray-900 dark:bg-gray-900 dark:text-gray-100;
  font-family: var(--font-sans);
  margin: 0;
  padding: 0;
  position: relative;
  min-height: 100vh;
  scroll-behavior: smooth;
}

/* Cursive font for certificate names only */
.certificate-name {
  font-family: 'Snell Roundhand', 'Zapfino', 'Brush Script MT', 'Segoe Script', 'Lucida Handwriting', 'Apple Chancery', cursive;
}

/* Custom styles for wider layout */
.container {
  max-width: 100%;
}

@media (min-width: 640px) {
  .container {
    max-width: 640px;
  }
}

@media (min-width: 768px) {
  .container {
    max-width: 768px;
  }
}

@media (min-width: 1024px) {
  .container {
    max-width: 1024px;
  }
}

@media (min-width: 1280px) {
  .container {
    max-width: 1280px;
  }
}

@media (min-width: 1536px) {
  .container {
    max-width: 1536px;
  }
}

/* Fix for code elements in dark mode */
code {
  @apply bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100;
}

/* Ensure proper footer positioning */
#__next {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Reset any forced dark mode */
html:not(.dark) body {
  @apply bg-gray-100 text-gray-900;
}

/* Skip to content link styles */
.skip-to-content {
  position: absolute !important;
  top: -120px !important;
  left: 6px !important;
  background: #000 !important;
  color: #fff !important;
  padding: 8px !important;
  text-decoration: none !important;
  z-index: 10000 !important;
  border-radius: 4px !important;
  transition: top 0.3s !important;
  font-weight: bold !important;
  font-size: 14px !important;
}

/* Screen reader only class */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only:focus {
  position: absolute;
  width: auto;
  height: auto;
  padding: 1rem;
  margin: 0;
  overflow: visible;
  clip: auto;
  white-space: normal;
  top: 0;
  left: 0;
  background-color: #fff;
  color: #4F46E5; /* indigo-600 */
  font-weight: bold;
  text-decoration: underline;
  z-index: 50;
}

/* Dark mode focus styles */
@media (prefers-color-scheme: dark) {
  .sr-only:focus {
    background-color: #1F2937; /* gray-800 */
    color: #818CF8; /* indigo-400 */
  }
}

/* Ensure focus styles work in dark mode - only for actionable elements */
.dark a:focus,
.dark button:focus,
.dark input:focus,
.dark textarea:focus,
.dark select:focus,
.dark [role="button"]:focus,
.dark [tabindex]:not([tabindex="-1"]):focus {
  outline: 2px solid #818CF8; /* indigo-400 */
  outline-offset: 2px;
}

/* Remove focus-within from glass-morphism in dark mode as well */
.dark .glass-morphism:focus-within {
  outline: none;
}

/* Circular Chart Styles */
.circular-chart {
  display: block;
  margin: 0 auto;
  max-width: 80px;
  max-height: 80px;
}

.circle-bg {
  fill: none;
  stroke: rgba(255, 255, 255, 0.1);
  stroke-width: 2.8;
}

.circle {
  fill: none;
  stroke: rgba(255, 255, 255, 0.8);
  stroke-width: 2.8;
  stroke-linecap: round;
  animation: progress 1s ease-in-out forwards;
}

.percentage {
  fill: rgba(255, 255, 255, 0.9);
  font-family: var(--font-sans);
  font-size: 0.45rem;
  font-weight: 600;
  text-anchor: middle;
  dominant-baseline: middle;
}

@keyframes progress {
  0% {
    stroke-dasharray: 0 100;
  }
}

/* Tier Section Styling */
.tier-section {
  margin-bottom: 3rem;
}

.tier-header {
  margin-bottom: 2rem;
}

.tier-header-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: 2rem;
}

@media (min-width: 768px) {
  .tier-header-content {
    flex-direction: row;
    text-align: left;
  }
}

/* Unlock chip styles */
.unlock-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 9999px;
  border: 1px solid rgba(99, 102, 241, 0.4);
  background: rgba(99, 102, 241, 0.08);
  color: #1f2937;
  text-decoration: none;
  font-size: 12px;
  transition: transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;
}
.dark .unlock-chip {
  color: #e5e7eb;
  border-color: rgba(99, 102, 241, 0.5);
  background: rgba(99, 102, 241, 0.15);
}
.unlock-chip:hover {
  transform: translateY(-1px);
  background: rgba(99, 102, 241, 0.15);
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);
}

/* Sweet animated radio buttons */
.radio-option {
  display: flex;
  align-items: center;
  padding: 14px 16px;
  border-radius: 10px;
  border: 1px solid var(--radio-border, #e5e7eb);
  background: var(--radio-bg, #ffffff);
  cursor: pointer;
  transition: border-color 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;
}
.dark .radio-option {
  --radio-bg: rgba(31, 41, 55, 0.6);
  --radio-border: #374151;
}
.radio-option:hover {
  border-color: #93c5fd;
}
.radio-option.is-selected {
  --radio-border: #3b82f6;
  --radio-bg: #eff6ff;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
}
.dark .radio-option.is-selected {
  --radio-bg: rgba(30, 64, 175, 0.25);
}
.radio-option.is-correct {
  --radio-border: #10b981;
  --radio-bg: #ecfdf5;
  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.15);
}
.dark .radio-option.is-correct {
  --radio-bg: rgba(6, 95, 70, 0.35);
}
.radio-option.is-incorrect {
  --radio-border: #ef4444;
  --radio-bg: #fef2f2;
  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.15);
}
.dark .radio-option.is-incorrect {
  --radio-bg: rgba(127, 29, 29, 0.35);
}

.sweet-radio-input {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}
.sweet-radio-visual {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  border: 2px solid var(--radio-circle-border, #9ca3af);
  margin-right: 12px;
  position: relative;
  flex-shrink: 0;
  transition: border-color 0.2s ease;
}
.radio-option:hover .sweet-radio-visual {
  --radio-circle-border: #60a5fa;
}
.sweet-radio-input:checked + .sweet-radio-visual {
  --radio-circle-border: #3b82f6;
}
.sweet-radio-visual::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: radial-gradient(ellipse at center, #3b82f6 0%, #60a5fa 100%);
  transform: translate(-50%, -50%) scale(0);
  opacity: 0;
}
.sweet-radio-input:checked + .sweet-radio-visual::after {
  animation: radioFill 240ms ease-out forwards;
}

@keyframes radioFill {
  0% { transform: translate(-50%, -50%) scale(0.4); opacity: 0; }
  50% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.9; }
  100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
}

.radio-text {
  color: #1f2937;
}
.dark .radio-text { color: #e5e7eb; }

.tier-main-info {
  flex: 1;
}

.tier-title {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: white;
}

.tier-level {
  display: block;
  font-size: 1rem;
  font-weight: 500;
  opacity: 0.8;
  margin-bottom: 0.25rem;
}

.tier-description {
  font-size: 1.125rem;
  opacity: 0.9;
  margin-bottom: 1rem;
  color: white;
}

.tier-focus-area {
  font-size: 1rem;
  opacity: 0.8;
  color: white;
}

.tier-progress-summary {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
}

.tier-progress-ring {
  width: 80px;
  height: 80px;
}

.tier-stats {
  display: flex;
  gap: 1.5rem;
}

.stat-item {
  text-align: center;
  color: white;
}

.stat-number {
  display: block;
  font-size: 1.25rem;
  font-weight: 700;
  margin-bottom: 0.25rem;
}

.stat-label {
  font-size: 0.875rem;
  opacity: 0.8;
}

.learning-objectives {
  margin-top: 2.5rem;
  padding-top: 2.5rem;
  border-top: 1px solid rgba(255, 255, 255, 0.15);
}

.objectives-title {
  font-size: 1.125rem;
  font-weight: 600;
  margin-bottom: 1rem;
  color: white;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  text-align: left;
  line-height: 1.3;
}

.objectives-title::before {
  content: 'ðŸŽ¯';
  font-size: 1rem;
}

.objectives-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 0.75rem;
}

.objective-item {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  color: white;
  opacity: 0.95;
  padding: 0.375rem;
  border-radius: 0.375rem;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  transition: all 0.2s ease;
  text-align: left;
  font-size: 0.875rem;
  line-height: 1.4;
}

.objective-item:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.2);
  transform: translateY(-1px);
}

.objective-icon {
  width: 16px;
  height: 16px;
  background: linear-gradient(135deg, #10B981, #059669);
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: bold;
  flex-shrink: 0;
  box-shadow: 0 1px 3px rgba(16, 185, 129, 0.3);
  margin-top: 0.125rem;
}

.modules-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
}

@media (min-width: 768px) {
  .modules-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (min-width: 1024px) {
  .modules-grid {
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  }
}

.tier-completion-celebration {
  margin-top: 2rem;
  padding: 2rem;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 1rem;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.celebration-content {
  color: white;
}

.celebration-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  display: block;
}

.celebration-title {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
}

.celebration-message {
  margin-bottom: 1.5rem;
  opacity: 0.9;
}

.next-tier-button {
  background: rgba(255, 255, 255, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.3);
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.next-tier-button:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

/* Remove the problematic focus-within rule that was applying focus to all glass containers */
.glass-morphism:focus-within {
  outline: none;
}
